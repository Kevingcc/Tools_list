<!DOCTYPE html>
<!-- saved from url=(0049)https://www.cnblogs.com/zhaijiahui/p/8459661.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style class="darkreader darkreader--fallback" media="screen"></style><style class="darkreader darkreader--text" media="screen"></style><style class="darkreader darkreader--invert" media="screen"></style><style class="darkreader darkreader--inline" media="screen">[data-darkreader-inline-bgcolor] {
  background-color: var(--darkreader-inline-bgcolor) !important;
}
[data-darkreader-inline-bgimage] {
  background-image: var(--darkreader-inline-bgimage) !important;
}
[data-darkreader-inline-border] {
  border-color: var(--darkreader-inline-border) !important;
}
[data-darkreader-inline-border-bottom] {
  border-bottom-color: var(--darkreader-inline-border-bottom) !important;
}
[data-darkreader-inline-border-left] {
  border-left-color: var(--darkreader-inline-border-left) !important;
}
[data-darkreader-inline-border-right] {
  border-right-color: var(--darkreader-inline-border-right) !important;
}
[data-darkreader-inline-border-top] {
  border-top-color: var(--darkreader-inline-border-top) !important;
}
[data-darkreader-inline-boxshadow] {
  box-shadow: var(--darkreader-inline-boxshadow) !important;
}
[data-darkreader-inline-color] {
  color: var(--darkreader-inline-color) !important;
}
[data-darkreader-inline-fill] {
  fill: var(--darkreader-inline-fill) !important;
}
[data-darkreader-inline-stroke] {
  stroke: var(--darkreader-inline-stroke) !important;
}
[data-darkreader-inline-outline] {
  outline-color: var(--darkreader-inline-outline) !important;
}</style><style class="darkreader darkreader--user-agent" media="screen">html {
    background-color: #1a1b1a !important;
}
html, body, input, textarea, select, button {
    background-color: #1a1b1a;
}
html, body, input, textarea, select, button {
    border-color: #5d5b56;
    color: #f8efe1;
}
a {
    color: #5393db;
}
table {
    border-color: #514f4b;
}
::placeholder {
    color: #c5bcac;
}
::selection {
    background-color: #1c5ca8;
    color: #fffffc;
}
::-moz-selection {
    background-color: #1c5ca8;
    color: #fffffc;
}
input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill {
    background-color: #585b15 !important;
    color: #f8efe1 !important;
}
::-webkit-scrollbar {
    background-color: #1f1f1e;
    color: #d1c9b9;
}
::-webkit-scrollbar-thumb {
    background-color: #2e2e2d;
}
::-webkit-scrollbar-thumb:hover {
    background-color: #363736;
}
::-webkit-scrollbar-thumb:active {
    background-color: #424241;
}
::-webkit-scrollbar-corner {
    background-color: #1a1b1a;
}
* {
    scrollbar-color: #2e2e2d #1f1f1e;
}</style>
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="referrer" content="origin">
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">
    <title>任意文件下载漏洞学习 - 时光不改 - 博客园</title>
    <meta property="og:description" content="任意文件下载漏洞，正常的利用手段是下载服务器文件，如脚本代码，服务器配置或者是系统配置等等。但是有的时候我们可能根本不知道网站所处的环境，以及网站的路径，这时候我们只能利用./ ../来逐层猜测路径，">
    <link type="text/css" rel="stylesheet" href="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/blog-common.css"><style class="darkreader darkreader--sync" media="screen"></style>
<link type="text/css" rel="stylesheet" href="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/356942.css"><style class="darkreader darkreader--sync" media="screen"></style>
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/bundle-BlackLowKey-mobile.css"><style class="darkreader darkreader--sync" media="screen"></style>
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/zhaijiahui/rss">
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/zhaijiahui/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/zhaijiahui/wlwmanifest.xml">
    <script async="" src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/analytics.js"></script><script type="text/javascript" src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/encoder.js"></script><script src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/jquery-2.2.0.min.js"></script><style class="darkreader darkreader--override" media="screen">.jfk-bubble {
    background-color: #000000 !important;
}
.vimvixen-hint {
    background-color: #755606 !important;
    border-color: #d6b43b !important;
    color: #fff1ce !important;
}</style>
    <script>var currentBlogId=356942;var currentBlogApp='zhaijiahui',cb_enable_mathjax=false;var isLogined=false;</script>
    <script src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/blog-common.js" type="text/javascript"></script>
<link rel="preload" href="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/f.txt" as="script"><script type="text/javascript" src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/f.txt"></script><link rel="preload" href="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/f(1).txt" as="script"><script type="text/javascript" src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/f(1).txt"></script><script src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/pubads_impl_2019070801.js" async=""></script></head>
<body>
<a name="top"></a>


<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="https://www.cnblogs.com/zhaijiahui/"><img id="blogLogo" src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/logo.gif" alt="返回主页"></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/zhaijiahui/">时光不改</a></h1>
<h2>时光荏苒，初心不改。<br>
https://github.com/zhaijiahui/<br>
https://zhaijiahui.github.io/</h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/zhaijiahui/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/%E6%97%B6%E5%85%89%E4%B8%8D%E6%94%B9">联系</a></li>
<li><a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/zhaijiahui/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="https://www.cnblogs.com/zhaijiahui/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 92&nbsp; </span>
<span id="stats_article_count">文章 - 0&nbsp; </span>
<span id="stats-comment_count">评论 - 8</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
        <div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/zhaijiahui/p/8459661.html">任意文件下载漏洞学习</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body"><p>&nbsp;任意文件下载漏洞，正常的利用手段是下载服务器文件，如脚本代码，服务器配置或者是系统配置等等。但是有的时候我们可能根本不知道网站所处的环境，以及网站的路径，这时候我们只能利用./ ../来逐层猜测路径，让漏洞利用变得繁琐。</p>
<p>&nbsp;</p>
<h1 id="autoid-0-0-0">漏洞介绍</h1>
<p>一些网站由于业务需求，往往需要提供文件查看或文件下载功能，但若对用户查看或下载的文件不做限制，则恶意用户就能够查看或下载任意敏感文件，这就是文件查看与下载漏洞。</p>
<p>&nbsp;</p>
<h1 id="autoid-1-0-0">利用条件</h1>
<p>* 存在读文件的函数</p>
<p>* 读取文件的路径用户可控且未校验或校验不严</p>
<p>* 输出了文件内容</p>
<p>&nbsp;</p>
<h1 id="autoid-2-0-0">漏洞危害</h1>
<p>下载服务器任意文件，如脚本代码、服务及系统配置文件等</p>
<p>可用得到的代码进一步代码审计，得到更多可利用漏洞</p>
<p>&nbsp;</p>
<h1 id="autoid-3-0-0">漏洞挖掘</h1>
<p>可以用Google hacking或Web漏洞扫描器</p>
<p>Google search利用</p>
<div class="cnblogs_code">
<pre>inurl:<span style="color: rgb(128, 0, 0); --darkreader-inline-color:#f08f86;" data-darkreader-inline-color="">"</span><span style="color: rgb(128, 0, 0); --darkreader-inline-color:#f08f86;" data-darkreader-inline-color="">readfile.php?file=</span><span style="color: rgb(128, 0, 0); --darkreader-inline-color:#f08f86;" data-darkreader-inline-color="">"</span></pre>
</div>
<p>&nbsp;</p>
<p>从链接上看，形如：</p>
<div class="cnblogs_code">
<pre><span style="color: rgb(0, 0, 0); --darkreader-inline-color:#f8efe1;" data-darkreader-inline-color="">    • download.php?path=
    • download.php?file=
    • down.php?file=
    • data.php?file=
    • readfile.php?file=
    • read.php?filename=</span></pre>
</div>
<p>&nbsp;</p>
<p>从参数名看，形如：</p>
<div class="cnblogs_code"><div>按 Ctrl+C 复制代码</div><textarea style="width: 674px; height: 371.2px; font-family: &quot;Courier New&quot;; font-size: 12px; line-height: 1.5;"></textarea><div>按 Ctrl+C 复制代码</div></div>
<p>&nbsp;</p>
<p>当遇到一个任意文件下载时，我们的一般利用思路:</p>
<p>&nbsp;</p>
<p>下载常规的配置文件，例如: ssh,weblogic,ftp,mysql等相关配置</p>
<p>下载各种.log文件，从中寻找一些后台地址，文件上传点之类的地方，如果运气好的话会获得一些前辈们的后门。</p>
<p>下载web业务文件进行白盒审计，利用漏洞进一步攻入服务器。</p>
<p>&nbsp;</p>
<p>以上是正常情况下的利用思路，Daybreak在从事行业到现在，将这些思路进行延伸，整理分析出了自己的一套思路。</p>
<p>&nbsp;</p>
<p>当我们遇到一个任意文件下载漏洞时首先要注意下载的权限问题。因为权限决定我们能下载的文件范围。</p>
<p>尝试读取/root/.bash_history看自己是否具有root权限。如果没有的话。我们只能按部就班的利用../来回跳转读取一些.ssh下的配置信息文件，读取mysql下的.bash_history文件。来查看是否记录了一些可以利用的相关信息。然后逐个下载我们需要审计的代码文件，但是下载的时候变得很繁琐，我们只能尝试去猜解目录，然后下载一些中间件的记录日志进行分析。</p>
<p>&nbsp;</p>
<p>如果我们遇到的是java+oracle/ jsp+oracle环境，</p>
<p>可以先下载/WEB-INF/classes/applicationContext.xml 文件，这里面记载的是web服务器的相应配置，然后下载/WEB-INF/classes/xxx/xxx/ccc.class对文件进行反编译，然后搜索文件中的upload关键字看是否存在一些api接口，如果存在的话我们可以本地构造上传页面用api接口将我们的文件传输进服务器。</p>
<p>&nbsp;</p>
<p>如果具有root权限</p>
<p>这时候很多人肯定会说&nbsp; 具有root权限直接去读shadow文件了&nbsp; 但是很多时候我们遇到的服务器可能只对外开放了 80，443两个端口这时候我们即使获得了密码作用也不打，但是具备root权限对任意文件下载利用是绝对的。</p>
<p>&nbsp;</p>
<p>在linux中有这样一个命令 locate 是用来查找文件或目录的，它不搜索具体目录，而是搜索一个数据库/var/lib/mlocate/mlocate.db。这个数据库中含有本地所有文件信息。Linux系统自动创建这个数据库，并且每天自动更新一次。</p>
<p>当我们不知道路径是什么的情况下，这个可以说是一个核武器了，我们利用任意文件下载漏洞将mlocate.db文件下载下来，利用locate命令将数据输出成文件，这里面包含了全部的文件路径信息。</p>
<p>locate 读取方法</p>
<div class="cnblogs_code">
<pre><span style="color: rgb(0, 0, 255); --darkreader-inline-color:#4f81d8;" data-darkreader-inline-color="">locate</span> mlocate.db admin</pre>
</div>
<p>可以将mlocate.db中包含admin内容全部输出来</p>
<p>&nbsp;</p>
<p>利用这个文件我们可以获取到该服务器任何我们想要的内容并下载出来而不用一个一个去猜解目录，但是这个文件只有root用户才能读取。</p>
<p>另一方面我们也可以利用linux内核的一个文件/proc/self/cmdline当前进程的cmdline参数，可以获取到路径信息。</p>
<p>&nbsp;</p>
<p>总体来说，任意文件下载漏洞的利用主要是为了信息收集，我们通过对服务器配置文件的下载，获取到大量的配置信息、源码，从而根据获取的信息来进一步挖掘服务器漏洞从而入侵。</p>
<p>&nbsp;</p>
<p>以下整理了一些下载利用文件。</p>
<blockquote>
<p>Windows：</p>
<p>C:\boot.ini //查看系统版本</p>
<p>C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件</p>
<p>C:\Windows\repair\sam //存储系统初次安装的密码</p>
<p>C:\Program Files\mysql\my.ini //Mysql配置</p>
<p>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root</p>
<p>C:\Windows\php.ini //php配置信息</p>
<p>C:\Windows\my.ini //Mysql配置信息</p>
<p>C:\Windows\win.ini //Windows系统的一个基本系统配置文件</p>
<p>Linux：</p>
<p>/root/.ssh/authorized_keys</p>
<p>/root/.ssh/id_rsa</p>
<p>/root/.ssh/id_ras.keystore</p>
<p>/root/.ssh/known_hosts //记录每个访问计算机用户的公钥</p>
<p>/etc/passwd</p>
<p>/etc/shadow</p>
<p>/etc/my.cnf //mysql配置文件</p>
<p>/etc/httpd/conf/httpd.conf //apache配置文件</p>
<p>/root/.bash_history //用户历史命令记录文件</p>
<p>/root/.mysql_history //mysql历史命令记录文件</p>
<p>/proc/mounts //记录系统挂载设备</p>
<p>/porc/config.gz //内核配置文件</p>
<p>/var/lib/mlocate/mlocate.db //全文件路径</p>
<p>/porc/self/cmdline //当前进程的cmdline参数</p>
</blockquote>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h1 id="autoid-4-0-0">漏洞验证</h1>
<p>&nbsp;</p>
<p>• index.php?f=../../../../../../etc/passwd</p>
<p>• index.php?f=../index.php</p>
<p>• index.php?f=ﬁle:///etc/passwd</p>
<p>注：当参数f的参数值为php文件时，若是文件被解析则是文件包含漏洞，</p>
<p>&nbsp;&nbsp;&nbsp; 若显示源码或提示下载则是文件查看与下载漏洞</p>
<p>&nbsp;</p>
<h1 id="autoid-5-0-0">修复方案</h1>
<p>&nbsp;</p>
<p>* 过滤.(点)，使用户在url中不能回溯上级目录</p>
<p>* 正则严格判断用户输入参数的格式</p>
<p>* php.ini配置open_basedir限定文件访问范围</p>
<p>&nbsp;</p>
<h1 id="autoid-6-0-0">参考链接</h1>
<blockquote>
<p>http://mp.weixin.qq.com/s/iYwd0vIlratE_t_VasroLA</p>
<p>作者：reber</p>
<p>链接：https://www.jianshu.com/p/f4b06f59c4cb</p>
<p>來源：简书</p>
<p>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>
</blockquote>
<p>&nbsp;</p></div><div id="MySignature" style="display: block;">知识要大家一起分享，但带上原文链接是对作者的尊重。</div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory">分类: <a href="https://www.cnblogs.com/zhaijiahui/category/1022575.html" target="_blank">安全之路</a></div>
<div id="EntryTag">标签: <a href="https://www.cnblogs.com/zhaijiahui/tag/%E6%BC%8F%E6%B4%9E%E5%AD%A6%E4%B9%A0/">漏洞学习</a></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(8459661,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;d909f6c1-60a8-404d-cd71-08d49c352df2&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/zhaijiahui/" target="_blank"><img src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/20170521231315.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="https://home.cnblogs.com/u/zhaijiahui/">时光不改</a><br>
            <a href="https://home.cnblogs.com/u/zhaijiahui/followees">关注 - 0</a><br>
            <a href="https://home.cnblogs.com/u/zhaijiahui/followers">粉丝 - 8</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;d909f6c1-60a8-404d-cd71-08d49c352df2&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(8459661,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">0</span>
    </div>
    <div class="buryit" onclick="votePost(8459661,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
<script type="text/javascript">
    currentDiggType = 0;
</script></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="https://www.cnblogs.com/zhaijiahui/p/8449429.html" class="p_n_p_prefix">« </a> 上一篇：<a href="https://www.cnblogs.com/zhaijiahui/p/8449429.html" title="发布于2018-02-15 13:16">Centos7 nginx报错403 forbidden</a><br><a href="https://www.cnblogs.com/zhaijiahui/p/8467686.html" class="p_n_p_prefix">» </a> 下一篇：<a href="https://www.cnblogs.com/zhaijiahui/p/8467686.html" title="发布于2018-02-24 21:09">php-mysql问题：mysqli_connect(): Headers and client library minor version mismatch. Headers:50556 Library:50637</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2018-02-22 17:47</span> <a href="https://www.cnblogs.com/zhaijiahui/">时光不改</a> 阅读(<span id="post_view_count">6222</span>) 评论(<span id="post_comment_count">0</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=8459661" rel="nofollow">编辑</a> <a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#" onclick="AddToWz(8459661);return false;">收藏</a></div>
	</div>
	<script type="text/javascript">var allowComments=true,cb_blogId=356942,cb_entryId=8459661,cb_blogApp=currentBlogApp,cb_blogUserGuid='d909f6c1-60a8-404d-cd71-08d49c352df2',cb_entryCreatedDate='2018/2/22 17:47:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=false;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-工控&#39;)">【推荐】超50万C++/C#源码: 大型实时仿真组态图形源码</a><br><a href="https://www.grapecity.com.cn/developer/spreadjs?utm_source=cnblogs&amp;utm_medium=blogpage&amp;utm_term=bottom&amp;utm_content=SpreadJS&amp;utm_campaign=community" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-SpreadJS&#39;)">【前端】SpreadJS表格控件，可嵌入系统开发的在线Excel</a><br><a href="https://gitee.com/enterprises?from=bky-1" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-gitee&#39;)">【推荐】码云企业版，高效的企业级软件协作开发管理平台</a><br><a href="https://q.cnblogs.com/" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-博问&#39;)">【推荐】程序员问答平台，解决您开发中遇到的技术难题</a><br></div>
<div id="opt_under_post"></div>
<script async="async" src="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/gpt.js"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id="cnblogs_c1" class="c_ad_block"></div>
<div id="under_post_news"><div class="recomm-block"><b>相关博文：</b><br>·  <a href="https://www.cnblogs.com/lgf01010/p/9595391.html" target="_blank" onclick="clickRecomItmem(9595391)">文件包含漏洞</a><br>·  <a href="https://www.cnblogs.com/huangye-dream/p/3542424.html" target="_blank" onclick="clickRecomItmem(3542424)">PHP文件包含漏洞攻防实战</a><br>·  <a href="https://www.cnblogs.com/xiaozi/p/10053194.html" target="_blank" onclick="clickRecomItmem(10053194)">【代码审计】EasySNS_V1.6前台任意文件下载漏洞分析</a><br>·  <a href="https://www.cnblogs.com/Time-dog/p/5743749.html" target="_blank" onclick="clickRecomItmem(5743749)">7_文件上传漏洞</a><br>·  <a href="https://www.cnblogs.com/KevinGeorge/p/8242339.html" target="_blank" onclick="clickRecomItmem(8242339)">WEB安全第二篇--用文件搞定服务器：任意文件上传、文件包含与任意目录文件遍历</a><br></div></div>
<div id="cnblogs_c2" class="c_ad_block" style="display: none;">
    <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;"></div>
</div>
<div id="under_post_kb"><div class="itnews c_ad_block"><b>最新新闻</b>：<br> ·  <a href="https://news.cnblogs.com/n/628214/" target="_blank">史前人类打开活人的头盖骨……要做啥</a><br> ·  <a href="https://news.cnblogs.com/n/628213/" target="_blank">加州11岁女孩遭遇iPhone 6燃烧</a><br> ·  <a href="https://news.cnblogs.com/n/628212/" target="_blank">新商标表明华为鸿蒙系统在海外或叫做“Harmony OS”</a><br> ·  <a href="https://news.cnblogs.com/n/628211/" target="_blank">Cloudflare 7.2 全球瘫痪罪魁祸首：.*(?：.*=.*)</a><br> ·  <a href="https://news.cnblogs.com/n/628210/" target="_blank">德国学校封杀Microsoft Office 365：因隐私担忧、使用是非法的</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><script type="text/javascript">window['__document_write_ajax_callbacks__']['4']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['5']();</script><script>window['__document_write_ajax_callbacks__']['1']();</script>
<script type="text/javascript">window['__document_write_ajax_callbacks__']['6']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['7']();</script><script type="text/javascript">window['__document_write_ajax_callbacks__']['2']();</script>
<link href="./任意文件下载漏洞学习 - 时光不改 - 博客园_files/marvin.nav-zhaijh.css" rel="stylesheet"><style class="darkreader darkreader--cors" media="screen">#sideToolbar {
	position: fixed;
	bottom: -12px;
	right: 25px;
	width: 250px;
	height: 440px
}
#sideCatalog{
	background-color:#fff;
	padding-bottom:10px;
	border-radius:5px;
}
#sideCatalog-sidebar {
	-moz-border-bottom-colors: none;
	-moz-border-left-colors: none;
	-moz-border-right-colors: none;
	-moz-border-top-colors: none;
	background-color: #eaeaea;
	border-color: -moz-use-text-color #eaeaea;
	border-image: none;
	border-left: 1px solid #eaeaea;
	border-right: 1px solid #eaeaea;
	border-style: none solid;
	border-width: 0 1px;
	height: 353px;
	left: 40px;
	position: absolute;
	top: 0;
	width: 0
}
#sideCatalog-catalog {
	height: 325px;
	padding-top: 18px;
	overflow-x: hidden;
	overflow-y: scroll;
	left: 13px;
	padding-left: 30px;
	position: relative
}
#sideCatalog #sideCatalog-sidebar .sideCatalog-sidebar-top {
	cursor: pointer;
	top: 0
}
#sideCatalog #sideCatalog-sidebar .sideCatalog-sidebar-bottom {
	bottom: 0
}
#sideCatalog #sideCatalog-sidebar .sideCatalog-sidebar-top,#sideCatalog #sideCatalog-sidebar .sideCatalog-sidebar-bottom {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll 0 -199px transparent;
	height: 10px;
	left: -5px;
	overflow: hidden;
	position: absolute;
	width: 10px
}
#sideCatalog li {
	margin: 0px;
	padding: 0 7px;
	text-align: left;
	position: relative
}
#sideCatalog li: hover {
	background-color: #f5f5f5
}
#sideCatalog-catalog ul .active {
	background-color: #f5f5f5
}
#sideCatalog-catalog .active a {
	color: #519cea
}
#sideCatalog-catalog a: hover {
	color: #519cea
}
#sideCatalog span: first-child {
	color: #999;
	font-family: Arial;
	font-size: 14px;
	font-weight: bold;
	padding-right: 5px
}
#sideCatalog li.h2Offset {
	padding-left: 45px;
	text-indent: -25px
}
#sideCatalog li.h3Offset {
	padding-left: 90px;
	text-indent: -50px
}
#sideCatalog li.h4Offset {
	padding-left: 120px;
	text-indent: -75px
}
#sideCatalog a {
	text-decoration: none;
	color: #555;
	font-weight: bold
}
.sideCatalog-dot {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") repeat scroll 0 -222px transparent;
	cursor: pointer;
	font-size: 12px;
	height: 10px;
	left: -20px;
	line-height: 12px;
	overflow: hidden;
	position: absolute;
	top: 4px;
	width: 6px
}
#sideCatalog .highlight .sideCatalog-dot {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll -271px -38px transparent;
	height: 13px;
	left: -23px;
	top: 3px;
	width: 18px
}
#sideCatalogBtn {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll 0 0 transparent;
	cursor: pointer;
	display: block;
	height: 45px;
	margin-bottom: 5px;
	margin-left: 40px;
	position: relative;
	width: 45px;
	margin-top: 10px;
	outline: 0
}
#sideCatalogBtn: hover {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll -154px 0 transparent
}
.sideCatalogBtnDisable {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll -104px 0 transparent !important
}
#sideToolbar-up {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll -1px -62px transparent;
	border-radius: 2px;
	display: block;
	height: 45px;
	margin-left: 5px;
	width: 45px;
	outline: 0
}
#sideToolbar-up: hover {
	background: url("https://files.cnblogs.com/files/zhaijiahui/sideToolbar.gif") no-repeat scroll -74px -62px transparent
}</style><style class="darkreader darkreader--sync" media="screen"></style><div id="profile_block">昵称：<a href="https://home.cnblogs.com/u/zhaijiahui/">时光不改</a><br>园龄：<a href="https://home.cnblogs.com/u/zhaijiahui/" title="入园时间：2017-05-21">2年1个月</a><br>粉丝：<a href="https://home.cnblogs.com/u/zhaijiahui/followers/">8</a><br>关注：<a href="https://home.cnblogs.com/u/zhaijiahui/followees/">0</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow(&#39;d909f6c1-60a8-404d-cd71-08d49c352df2&#39;)">+加关注</a></div><script type="text/javascript">window['__document_write_ajax_callbacks__']['8']();</script><script>window['__document_write_ajax_callbacks__']['3']();</script></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style=""><table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/06/01&#39;);return false;">&lt;</a></td><td align="center">2019年7月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/08/01&#39;);return false;">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" align="center" abbr="日" scope="col">日</th><th class="CalDayHeader" align="center" abbr="一" scope="col">一</th><th class="CalDayHeader" align="center" abbr="二" scope="col">二</th><th class="CalDayHeader" align="center" abbr="三" scope="col">三</th><th class="CalDayHeader" align="center" abbr="四" scope="col">四</th><th class="CalDayHeader" align="center" abbr="五" scope="col">五</th><th class="CalDayHeader" align="center" abbr="六" scope="col">六</th></tr><tr><td class="CalOtherMonthDay" align="center">30</td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td align="center">4</td><td align="center">5</td><td class="CalWeekendDay" align="center">6</td></tr><tr><td class="CalWeekendDay" align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">10</td><td align="center">11</td><td align="center">12</td><td class="CalWeekendDay" align="center">13</td></tr><tr><td class="CalTodayDay" align="center">14</td><td align="center">15</td><td align="center">16</td><td align="center">17</td><td align="center">18</td><td align="center">19</td><td class="CalWeekendDay" align="center">20</td></tr><tr><td class="CalWeekendDay" align="center">21</td><td align="center">22</td><td align="center">23</td><td align="center">24</td><td align="center">25</td><td align="center">26</td><td class="CalWeekendDay" align="center">27</td></tr><tr><td class="CalWeekendDay" align="center">28</td><td align="center">29</td><td align="center">30</td><td align="center">31</td><td class="CalOtherMonthDay" align="center">1</td><td class="CalOtherMonthDay" align="center">2</td><td class="CalOtherMonthDay" align="center">3</td></tr><tr><td class="CalOtherMonthDay" align="center">4</td><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td><td class="CalOtherMonthDay" align="center">7</td><td class="CalOtherMonthDay" align="center">8</td><td class="CalOtherMonthDay" align="center">9</td><td class="CalOtherMonthDay" align="center">10</td></tr>
</tbody></table></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>

</div>
</div>

</div><div id="sidebar_shortcut" class="sidebar-block">
<div class="catListLink">
<h3 class="catListTitle">常用链接</h3>
<ul>
<li><a href="https://www.cnblogs.com/zhaijiahui/p/" title="我的博客的随笔列表">我的随笔</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/MyComments.html" title="我发表过的评论列表">我的评论</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/RecentComments.html" title="我的博客的评论列表">最新评论</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/" title="我的博客的标签列表">我的标签</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div></div><div id="sidebar_toptags" class="sidebar-block">
<div class="catListTag">
<h3 class="catListTitle">我的标签</h3>
<ul>
<li><a href="https://www.cnblogs.com/zhaijiahui/tag/ctf/">ctf</a>(13)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">漏洞复现</a>(11)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/%E5%AE%9E%E9%AA%8C%E5%90%A7/">实验吧</a>(9)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/python/">python</a>(9)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>(8)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/python3.5/">python3.5</a>(7)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/android/">android</a>(6)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/%E9%80%86%E5%90%91/">逆向</a>(5)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/python3/">python3</a>(4)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/pwnable.kr/">pwnable.kr</a>(3)</li><li><a href="https://www.cnblogs.com/zhaijiahui/tag/">更多</a></li>
</ul>
</div></div><div id="sidebar_categories">
<div id="sidebar_postcategory" class="catListPostCategory sidebar-block">
<h3 class="catListTitle">随笔分类</h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="https://www.cnblogs.com/zhaijiahui/category/1010286.html">Android逆向基础(5)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="https://www.cnblogs.com/zhaijiahui/category/1027557.html">ctf 逆向练习题(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="https://www.cnblogs.com/zhaijiahui/category/1043242.html">pwnable.kr(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="https://www.cnblogs.com/zhaijiahui/category/1011493.html">python问题汇总(8)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="https://www.cnblogs.com/zhaijiahui/category/1011495.html">python小练习(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="https://www.cnblogs.com/zhaijiahui/category/1016413.html">python学习(7)</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="https://www.cnblogs.com/zhaijiahui/category/1022575.html">安全之路(31)</a> </li>

<li><a id="CatList_LinkList_0_Link_7" href="https://www.cnblogs.com/zhaijiahui/category/1091208.html">读书笔记(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_8" href="https://www.cnblogs.com/zhaijiahui/category/1034862.html">二进制之路(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_9" href="https://www.cnblogs.com/zhaijiahui/category/1155331.html">工具使用(7)</a> </li>

<li><a id="CatList_LinkList_0_Link_10" href="https://www.cnblogs.com/zhaijiahui/category/1010287.html">实验吧ctf(10)</a> </li>

<li><a id="CatList_LinkList_0_Link_11" href="https://www.cnblogs.com/zhaijiahui/category/1190775.html">学习笔记(15)</a> </li>

<li><a id="CatList_LinkList_0_Link_12" href="https://www.cnblogs.com/zhaijiahui/category/1106315.html">杂乱的ctf(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_13" href="https://www.cnblogs.com/zhaijiahui/category/1060412.html">杂乱的问题(10)</a> </li>

</ul>

</div>

</div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock"><ul><li><a href="https://www.cnblogs.com/zhaijiahui/p/8398480.html">1. Python问题：UnboundLocalError： local variable 'xxx' referenced before assignment(67124)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/8391701.html">2. Python问题：'Nonetype' object is not iterable(58166)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/6926159.html">3. python问题：TypeError: a bytes-like object is required, not 'str'(12107)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/7344778.html">4. python问题：AttributeError: 'module' object has no attribute 'SSL_ST_INIT'(9795)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/9490949.html">5. python3 字典常见用法总结(9172)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">推荐排行榜</h3>
<div id="TopDiggPostsBlock"><ul><li><a href="https://www.cnblogs.com/zhaijiahui/p/8398480.html">1. Python问题：UnboundLocalError： local variable 'xxx' referenced before assignment(3)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/8391701.html">2. Python问题：'Nonetype' object is not iterable(2)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/7344778.html">3. python问题：AttributeError: 'module' object has no attribute 'SSL_ST_INIT'(2)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/10789251.html">4. DoraBox 漏洞练习平台(1)</a></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/9160913.html">5. CEYE平台的使用(1)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright ©2019 时光不改
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->



<div id="sideToolbar" style="display: block;"><div class="sideCatalogBg" id="sideCatalog"><div id="sideCatalog-sidebar"><div class="sideCatalog-sidebar-top"></div><div class="sideCatalog-sidebar-bottom"></div></div><div id="sideCatalog-catalog"><ul class="nav" style="width:350px;zoom:1"><li class=""><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-0-0-0" title="漏洞介绍">漏洞介绍</a><span class="sideCatalog-dot"></span></li><li class=""><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-1-0-0" title="利用条件">利用条件</a><span class="sideCatalog-dot"></span></li><li class=""><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-2-0-0" title="漏洞危害">漏洞危害</a><span class="sideCatalog-dot"></span></li><li class="active"><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-3-0-0" title="漏洞挖掘">漏洞挖掘</a><span class="sideCatalog-dot"></span></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-4-0-0" title="漏洞验证">漏洞验证</a><span class="sideCatalog-dot"></span></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-5-0-0" title="修复方案">修复方案</a><span class="sideCatalog-dot"></span></li><li><a href="https://www.cnblogs.com/zhaijiahui/p/8459661.html#autoid-6-0-0" title="参考链接">参考链接</a><span class="sideCatalog-dot"></span></li></ul></div></div><a href="javascript:void(0);" id="sideCatalogBtn"></a></div><script type="text/javascript">getFollowStatus('d909f6c1-60a8-404d-cd71-08d49c352df2')</script></body></html>